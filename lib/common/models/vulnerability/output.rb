# encoding: UTF-8

class Vulnerability
  module Output
    # output the vulnerability
    def output(verbose = false, json_report = nil)
      puts
      puts critical("Title: #{title}")
      vuln_refs = ''
      references.each do |key, urls|
        methodname = "url_#{key}"
        
        urls.each do |u|
          next unless respond_to?(methodname)
          url = send(methodname, u)
          vuln_refs << ',' << url
          puts "    Reference: #{url}" if url
        end
      end
      vuln_item = VulnItem.new title, vuln_refs, fixed_in
      JsonReport.add_if_needed(vuln_item, json_report)
      puts notice("Fixed in: #{fixed_in}") if fixed_in
      
    end
  end
end
